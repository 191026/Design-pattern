### 理论八：如何用迪米特法则（LOD）实现“高内聚、松耦合”？

- 何为“高内聚、松耦合”？
  - 实际上，“高内聚、松耦合”是一个比较通用的设计思想，可以用来指导不同粒度代码的设计与开发，比如系统、模块、类，甚至是函数，也可以应用到不同的开发场景中，比如微服务、框架、组件、类库等。
  - 所谓高内聚，就是指相近的功能应该放到同一个类中，不相近的功能不要放到同一个类中。
  - 所谓松耦合是说，在代码中，类与类之间的依赖关系简单清晰。即使两个类有依赖关系，一个类的代码改动不会或者很少导致依赖类的代码改动。实际上，我们前面讲的依赖注入、接口隔离、基于接口而非实现编程，以及今天讲的迪米特法则，都是为了实现代码的松耦合。

- “内聚”和“耦合”之间的关系。
  - “高内聚”有助于“松耦合”，同理，“低内聚”也会导致“紧耦合”。

  <img src="/Users/qiyue/Library/Application Support/typora-user-images/image-20211019150543370.png" alt="image-20211019150543370" style="zoom:30%;" />

  - 图中左边部分的代码设计中，类的粒度比较小，每个类的职责都比较单一。相近的功能都放到了一个类中，不相近的功能被分割到了多个类中。这样类更加独立，代码的内聚性更好。因为职责单一，所以每个类被依赖的类就会比较少，代码低耦合。一个类的修改，只会影响到一个依赖类的代码改动。我们只需要测试这一个依赖类是否还能正常工作就行了。
  - 图中右边部分的代码设计中，类粒度比较大，低内聚，功能大而全，不相近的功能放到了一个类中。这就导致很多其他类都依赖这个类。当我们修改这个类的某一个功能代码的时候，会影响依赖它的多个类。我们需要测试这三个依赖类，是否还能正常工作。这也就是所谓的“牵一发而动全身”。

  



